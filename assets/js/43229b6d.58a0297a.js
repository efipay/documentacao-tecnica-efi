"use strict";(self.webpackChunkwebsite_efi=self.webpackChunkwebsite_efi||[]).push([[22],{4695:function(e,a,n){n.d(a,{GA:function(){return u},N1:function(){return r},T7:function(){return s},d6:function(){return d},jS:function(){return c},mj:function(){return i}});var t=n(7294),o=n(2949);function l(e){var a=e.children,n=e.backgroundColor,o=e.color;return t.createElement("span",{style:{backgroundColor:n,color:o,borderRadius:"12px",padding:"3px 10px 3px 10px",fontSize:"15px"}},a)}function r(e){return l({children:e.children,backgroundColor:"rgba(87,167,59,0.4)",color:"dark"===(0,o.I)().colorMode?"rgba(162,222,142,1)":"rgba(36,121,7,1)"})}function c(e){return l({children:e.children,backgroundColor:"rgba(243,156,18,0.4)",color:"dark"===(0,o.I)().colorMode?"rgba(252,213,151,1)":"rgba(166,102,0,1)"})}function i(e){return l({children:e.children,backgroundColor:"rgba(179,228,163,0.4)",color:"dark"===(0,o.I)().colorMode?"rgba(162,222,142,1)":"rgba(36,121,7,1)"})}function d(e){return l({children:e.children,backgroundColor:"rgba(11,161,194,0.4)",color:"dark"===(0,o.I)().colorMode?"rgba(119,214,234,1)":"rgba(0,97,119,1)"})}function u(e){return l({children:e.children,backgroundColor:"rgba(253,132,128,0.4)",color:"dark"===(0,o.I)().colorMode?"rgba(255,176,173,1)":"rgba(217,30,24,1)"})}function s(e){return l({children:e.children,color:"rgba(243,112,33,1)"})}},6745:function(e,a,n){n.d(a,{Z:function(){return d}});var t=n(7294),o=n(3253),l=n.n(o),r=n(4223),c=n(8189),i=n(5585);function d(e){var a=e.filename,n=t.useState(!1),o=n[0],d=n[1];var u=(0,t.useState)(""),s=u[0],m=u[1];return(0,t.useEffect)((function(){fetch(a).then((function(e){return e.text()})).then((function(e){return m(e)})).catch((function(e){return console.log(e)}))})),t.createElement("div",null,t.createElement("button",{className:"buttonModify2 button-referencia",onClick:function(){d(!0)}},"Consultar Atributos",t.createElement("svg",{width:"13.5",height:"13.5","aria-hidden":"true",viewBox:"0 0 24 24",class:"iconExternalLink_node_modules-@docusaurus-theme-classic-lib-theme-Icon-ExternalLink-styles-module"},t.createElement("path",{fill:"currentColor",d:"M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"}))),t.createElement(l(),{className:"modal",isOpen:o,onRequestClose:function(){d(!1)},ariaHideApp:!1,contentLabel:"Modal de exemplo"},t.createElement("div",{className:"conteudo-modal"},t.createElement("div",{className:"col-50"},t.createElement(r.D,{children:s,remarkPlugins:[i.Z],rehypePlugins:[c.Z]})))))}},9950:function(e,a,n){n.r(a),n.d(a,{assets:function(){return m},contentTitle:function(){return u},default:function(){return v},frontMatter:function(){return d},metadata:function(){return s},toc:function(){return k}});var t=n(7462),o=n(3366),l=(n(7294),n(3905)),r=n(4866),c=n(5162),i=(n(4695),n(6745),["components"]),d={id:"Recebendo_callbacks",title:"Recebendo_callbacks",hide_title:!0,sidebar_label:"Recebendo Callbacks"},u=void 0,s={unversionedId:"APIOpenFinance/Recebendo_callbacks",id:"APIOpenFinance/Recebendo_callbacks",title:"Recebendo_callbacks",description:"Recebendo Callbacks",source:"@site/docs/APIOpenFinance/Recebendo_callbacks.md",sourceDirName:"APIOpenFinance",slug:"/APIOpenFinance/Recebendo_callbacks",permalink:"/doc/docs/APIOpenFinance/Recebendo_callbacks",draft:!1,tags:[],version:"current",frontMatter:{id:"Recebendo_callbacks",title:"Recebendo_callbacks",hide_title:!0,sidebar_label:"Recebendo Callbacks"},sidebar:"someSidebar",previous:{title:"Devolu\xe7\xe3o",permalink:"/doc/docs/APIOpenFinance/Devolucao"},next:{title:"Introdu\xe7\xe3o",permalink:"/doc/docs/APIAberturaContas/Introducao"}},m={},k=[],b={toc:k},p="wrapper";function v(e){var a=e.components,n=(0,o.Z)(e,i);return(0,l.kt)(p,(0,t.Z)({},b,n,{components:a,mdxType:"MDXLayout"}),(0,l.kt)("h1",{className:"titulo"},"Recebendo Callbacks"),(0,l.kt)("div",{className:"subtitulo"},(0,l.kt)("div",{className:"light"},"Informa\xe7\xf5es sobre os recebimentos de callbacks da API Open Finance Ef\xed"),(0,l.kt)("hr",null),(0,l.kt)("p",null,"Esse servi\xe7o est\xe1 protegido por uma camada de autentica\xe7\xe3o mTLS. Os callbacks s\xe3o enviados pela Ef\xed via ",(0,l.kt)("code",null,"POST url-webhook-cadastrada\u200b/pix")," quando h\xe1 uma altera\xe7\xe3o no status do Pix.  "),(0,l.kt)("div",{className:"link-responsivo"},(0,l.kt)("div",{className:"requisicao"},(0,l.kt)("b",null,"Requisi\xe7\xe3o"),(0,l.kt)("p",null,"Uma requisi\xe7\xe3o ",(0,l.kt)("code",null,"POST")," \xe9 enviada pela Ef\xed para a URL que voc\xea cadastrou como webhook para uma determinada chave. Quando houver altera\xe7\xe3o no status de uma transa\xe7\xe3o Pix, envolvendo a chave associada, um objeto JSON (como os exemplos abaixo) ser\xe1 enviado ao seu servidor. Cada requisi\xe7\xe3o enviada possui um timeout de 60 segundos, isto \xe9, uma requisi\xe7\xe3o de callback \xe9 interrompida ao atingir 60 segundos sem resposta."),(0,l.kt)("details",{className:"no_border"},(0,l.kt)("summary",null,(0,l.kt)("b",null," Veja alguns exemplos:")),(0,l.kt)(r.Z,{defaultValue:"Exemplo1",values:[{label:"Exemplo 1 - Inicia\xe7\xe3o de Pagamento",value:"Exemplo1"},{label:"Exemplo 2 - Inicia\xe7\xe3o de Pagamento",value:"Exemplo2"},{label:"Exemplo - Devolu\xe7\xe3o",value:"Exemplo"}],mdxType:"Tabs"},(0,l.kt)(c.Z,{value:"Exemplo1",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'// Exemplo - 200 (Notifica\xe7\xe3o enviada com sucesso)\n{\n  "identificadorPagamento": "urn:instituicaoDetentoraDeConta:fd2be7c4-604c-4493-9236-78fe66f40597",\n  "valor": "9.90",\n  "status": "aceito",\n  "dataCriacao": "2024-09-20T18:37:23.000Z",\n  "endToEndId": "E090993562022060954525a47762681g",\n  "idProprio": "6236574863254",\n  "tipo": "pagamento" \n}\n\n'))),(0,l.kt)(c.Z,{value:"Exemplo2",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'// Exemplo - 200 (Notifica\xe7\xe3o enviada com sucesso)\n{\n  "identificadorPagamento": "urn:instituicaoDetentoraDeConta:fd2be7c4-604c-4493-9236-78fe66f40597",\n  "valor": "9.90",\n  "status": "expirado",\n  "dataCriacao": "2024-09-20T18:37:23.000Z",\n  "endToEndId": "E090993562022060954525a47762681g",\n  "idProprio": "6236574863254",\n  "tipo": "pagamento",\n  "motivo": "Pagamento recusado no destino"\n}\n'))),(0,l.kt)(c.Z,{value:"Exemplo",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'// Exemplo - 200 (Notifica\xe7\xe3o enviada com sucesso)\n{\n  "identificadorPagamento": "urn:nubank:eb164079-dbc3-37ec-80bd-1f5d5ea46cec",\n  "identificadorDevolucao": "D09089356202211301744509406dc544",\n  "endToEndId": "E09089356202211301744e53afc1c1c0",\n  "idProprio": "4ad0394de750cd22dcbed11882a9a775",\n  "valor": "0.01",\n  "status": "aceito",\n  "dataCriacao": "2022-11-30T17:44:35.000Z",\n  "tipo": "devolucao"\n}\n')))),(0,l.kt)("br",null),(0,l.kt)("b",null,"Respostas"),(0,l.kt)("br",null),(0,l.kt)("p",null," As requisi\xe7\xf5es de callback aguardam uma resposta com status HTTP 2XX. Caso o servidor do cliente retorne um status diferente, a Ef\xed far\xe1 at\xe9 10 novas tentativas de notifica\xe7\xe3o. A primeira nova tentativa ser\xe1 feita 5 minutos ap\xf3s a falha do envio do callback. Persistindo o erro, as tentativas subsequentes ser\xe3o enviadas em intervalos de tempo cada vez maiores, conforme mostra a tabela abaixo."),(0,l.kt)("div",{className:"admonition_tip"},(0,l.kt)("div",null,(0,l.kt)("img",{src:"/img/exclamation-triangle-green.svg"})," ",(0,l.kt)("b",null,"Importante!")),"Em casos onde o servidor do cliente retorna o status HTTP 429 (*too many requests*), os servidores da Ef\xed tentar\xe3o enviar a notifica\xe7\xe3o at\xe9 10 vezes tamb\xe9m de acordo com a tabela abaixo."),(0,l.kt)("br",null),(0,l.kt)("table",{className:"table",width:"200px",align:"center"},(0,l.kt)("tbody",null,(0,l.kt)("tr",null,(0,l.kt)("th",null,"N\xb0 datentativa"),(0,l.kt)("th",{align:"center"},"Tempo (em minutos)")),(0,l.kt)("tr",null,(0,l.kt)("td",null,"1"),(0,l.kt)("td",null,"5")),(0,l.kt)("tr",null,(0,l.kt)("td",null,"2"),(0,l.kt)("td",null,"10")),(0,l.kt)("tr",null,(0,l.kt)("td",null,"3"),(0,l.kt)("td",null,"20")),(0,l.kt)("tr",null,(0,l.kt)("td",null,"4"),(0,l.kt)("td",null,"40")),(0,l.kt)("tr",null,(0,l.kt)("td",null,"5"),(0,l.kt)("td",null,"80")),(0,l.kt)("tr",null,(0,l.kt)("td",null,"6"),(0,l.kt)("td",null,"160")),(0,l.kt)("tr",null,(0,l.kt)("td",null,"7"),(0,l.kt)("td",null,"320")),(0,l.kt)("tr",null,(0,l.kt)("td",null,"8"),(0,l.kt)("td",null,"640")),(0,l.kt)("tr",null,(0,l.kt)("td",null,"9"),(0,l.kt)("td",null,"1280")),(0,l.kt)("tr",null,(0,l.kt)("td",null,"10"),(0,l.kt)("td",null,"52560")))))))))}v.isMDXComponent=!0}}]);